
# Задание 1
S0 <- 100  # Начальное значение
a <- 0.5   # Параметр дрейфа
sigma <- 0.8  # Волатильность
delta <- 0.01  # Шаг дискретизации
k_max <- 1000  # Количество шагов
n <- k_max + 1  # Количество точек (включая начальную точку)

# Генерация случайных приращений для броуновского движения
epsilon <- rnorm(n, mean = 0, sd = sqrt(delta))

# Инициализация векторов для броуновского и геометрического броуновского движения
B <- numeric(n)  # Вектор для броуновского движения
S <- numeric(n)  # Вектор для геометрического броуновского движения
S[1] <- S0  # Начальное значение для геометрического броуновского движения

# Моделирование броуновского движения
for (k in 2:n) 
{
  B[k] <- B[k - 1] + epsilon[k]
}

# Моделирование геометрического броуновского движения
for (k in 1:k_max) 
{
  S[k + 1] <- S[1] * exp((a - sigma^2 / 2) * (k * delta) + sigma * B[k + 1])
}

# Визуализация процесса геометрического броуновского движения
plot(seq(0, k_max * delta, by = delta), S, type = "l", 
     col = "blue", xlab = "Время (t)", ylab = "S(t)", 
     main = "Моделирование геометрического броуновского движения", lwd = 1)
grid()

# Задание 2 ----

# Вычисление логарифмических приращений
X_k <- numeric(length(S) - 1)  # Вектор для приращений

for (k in 2:length(S)) 
{
  X_k[k - 1] <- log(S[k] / S[k - 1])  # Разности логарифмов для оценки параметров
}

# Оценка параметра mu (среднего значения приращений)
mu_hat <- mean(X_k)

# Оценка дисперсии sigma^2
sigma_sq_hat <- var(X_k)

# Преобразование оценок для получения a и sigma^2
sigma_hat_sq <- sigma_sq_hat / delta  # Оценка волатильности sigma^2 с учетом дискретизации
a_hat <- mu_hat / delta + sigma_hat_sq / 2  # Оценка дрейфа a

# Вывод результатов
cat("Оценка параметра a (сноса):", a_hat, "\n")
cat("Оценка параметра sigma^2 (волатильности):", sigma_hat_sq, "\n")
